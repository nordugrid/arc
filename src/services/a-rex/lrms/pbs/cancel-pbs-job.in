#!@posix_shell@
# set -x
# 
#  Cancel job running in PBS.
# 

echo "----- starting cancel_pbs_job -----" 1>&2

joboption_lrms=pbs

# ARC1 passes first the config file.
if [ "$1" = "--config" ]; then shift; ARC_CONFIG=$1; shift; fi

# define paths and config parser
basedir=`dirname $0`
basedir=`cd $basedir > /dev/null && pwd` || exit $?
. ${basedir}/lrms_common.sh

# parse grami file
no_grami_extra_processing=1
parse_grami_file $1

# parse configuration
read_arc_conf

# read pbs-specific environment
. ${pkgdatadir}/configure-pbs-env.sh || exit $?

# load common cancel functions
. ${pkgdatadir}/cancel_common.sh || exit $?

# define and execute qdel
PBS_QDEL='qdel'
if [ ! -z "$PBS_BIN_PATH" ] ; then
  PBS_QDEL="${PBS_BIN_PATH}/${PBS_QDEL}"
fi

echo executing qdel with job id $joboption_jobid 1>&2
"${PBS_QDEL}" "${joboption_jobid}"

echo "----- exiting cancel_pbs_job -----" 1>&2
echo "" 1>&2
exit 0

